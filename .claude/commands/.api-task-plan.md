You are an experienced software architect whose task is to create a detailed implementation plan for feature. Your plan will guide the development team in effectively and correctly implementing this feature.

Before we begin, review the following information:

1. Specification:
<specification>
## 11. Background Jobs and Async Operations

### 11.1 Email Notifications

**Not Exposed via REST API** - Handled by background hosted service

**Email Types** (from EmailNotifications table):
1. **DrawCompleted**: Sent immediately after draw execution
2. **WishlistUpdated**: Sent 1 hour after wishlist update

**Queue Processing**:
- Background service polls EmailNotifications table
- Query: `WHERE SentAt IS NULL AND ScheduledAt <= NOW() AND AttemptCount < MAX_ATTEMPTS`
- Retry logic with exponential backoff
- Update SentAt timestamp on success
- Increment AttemptCount and log LastError on failure


US-024: Receive Draw Completion Notification
Title: Get notified when draw is performed

Description:
As a participant, I want to receive an email when the draw is completed so that I know I can log in to see my assignment.

Acceptance Criteria:
- Given I am a participant and the organizer initiated the draw
- When the draw is successfully completed
- Then I receive an email notification
- And the email includes: group name, confirmation that draw occurred
- And the email encourages me to log in to see my assignment
- And the email does not contain my assignment information directly

Edge cases:
- Email is sent even if I'm currently logged in
- Email delivery failure doesn't block the draw completion
- Email includes a direct link to log in and view assignment
- Email is sent from a recognizable sender address

US-025: Receive Wishlist Update Notification
Title: Get notified when my recipient updates their wishlist

Description:
As a participant after the draw, I want to receive an email when my recipient updates their wishlist so that I can adjust my gift plans accordingly.

Acceptance Criteria:
- Given I am a participant, the draw is complete, and I have an assigned recipient
- When my recipient updates their wishlist
- Then I receive an email notification after approximately 1 hour delay
- And the email informs me that my recipient updated their wishlist
- And the email encourages me to log in to view the changes
- And the email does not contain the actual wishlist content
- And multiple updates within 1 hour result in only one email

Edge cases:
- Wishlists cannot be created before the draw, so all notifications are for post-draw updates
- Notification is sent only to the assigned Santa, not to all participants
- Email includes direct link to view the updated wishlist
- If recipient makes multiple rapid changes, only the final version triggers notification

### 5.4 Email Notifications and System Features

US-026: Send Draw Completion Email
Title: Notify all participants of completed draw

Description:
As the system, I want to send email notifications to all participants when a draw completes so that they know to check their assignments.

Acceptance Criteria:
- Given a draw has been successfully completed
- When the draw algorithm finishes
- Then an email is sent to each participant (including organizer)
- And the email contains: group name and login link
- And the email has clear subject line (e.g., "Your Secret Santa Draw is Complete!")
- And emails are sent asynchronously to avoid blocking the draw process

Edge cases:
- Email failures are logged but don't block draw completion
- Batch email sending to handle large groups
- Email includes branding consistent with application
- Email is mobile-friendly

US-027: Send Wishlist Update Email with Delay
Title: Notify Santa of recipient wishlist changes

Description:
As the system, I want to send wishlist update notifications with a 1-hour delay so that multiple rapid edits don't spam the recipient's Santa.

Acceptance Criteria:
- Given a participant has updated their wishlist after the draw
- When 1 hour has passed since the most recent update
- Then an email is sent to their assigned Santa
- And the email indicates that the wishlist was updated
- And the email includes a link to view the updated wishlist
- And if multiple updates occurred within the hour, only one email is sent

Edge cases:
- Wishlists can only be created/updated after draw completion, so all notifications are post-draw
- Delay timer does not reset with each new edit within the 1-hour window - first one counts for delay
- System tracks pending notifications to avoid duplicates
- Email includes timestamp of when wishlist was last updated
</specification>

2. Type definitions:
<type_definitions>
@SantaVibe.Backend\SantaVibe.Api\Data\Entities\
</type_definitions>

3. Tech stack:
<tech_stack>
@docs/tech-stack.md
</tech_stack>

4. Implementation rules:
<implementation_rules>
@docs/backend-guidelines.md
</implementation_rules>

5. Api plan:
<implementation_rules>
@docs/api-plan.md
</implementation_rules>


The final output should consist solely of the implementation plan in markdown format

Remember to save your implementation plan as docs/api-implementation-plan\{feature}-implementation-plan.md. Ensure the plan is detailed, clear, and provides comprehensive guidance for the development team.